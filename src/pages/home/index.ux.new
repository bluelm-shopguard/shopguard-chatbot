<template>
  <div class="page">
    <!-- Header -->
    <div class="chat-header">
      <div class="header-button" onclick="openSidebar">
        <text class="header-icon">☰</text>
      </div>
      <text class="chat-header-title">ShopGuard AI</text>
      <div class="header-button" onclick="startNewChat">
        <text class="header-icon">+</text>
      </div>
    </div>
    
    <!-- Main Content Area -->
    <div class="chat-content">
      <div class="chat-welcome">
        <div class="logo-container">
          <text class="logo-text">SG</text>
        </div>
        <text class="welcome-title">购物防诈骗助手</text>
        <text class="welcome-message">遇到可疑商品、卖家或付款方式？随时发给我分析。无论是商品截图、链接还是聊天记录，我都会帮你识别风险，提供明确的"虚假诈骗风险星级"和建议，让我们一起安心购物不踩坑！</text>
      </div>
    </div>
    
    <!-- Input Area - Redesigned to match webapp -->
    <div class="chat-input-area">
      <div class="input-area-toolbar">
        <div class="toolbar-button" onclick="handleImageUpload">
          <text class="toolbar-icon">🖼</text>
          <text class="toolbar-text">图片</text>
        </div>
        <div class="toolbar-button" onclick="handleWebSearch">
          <text class="toolbar-icon">🔍</text>
          <text class="toolbar-text">搜索</text>
        </div>
      </div>
      
      <div class="input-area-wrapper">
        <input class="text-input" type="text" placeholder="发消息给我分析一下..." onchange="handleInputChange"/>
        <div class="send-button" onclick="sendMessage">
          <text class="send-icon">↑</text>
        </div>
      </div>
    </div>
    
    <!-- Sidebar Component (Prepared but not fully implemented) -->
    <div class="sidebar-overlay" show="{{sidebarActive}}" onclick="closeSidebar">
    </div>
  </div>
</template>

<script>
export default {
  data: {
    message: '',
    isProcessingMessage: false,
    currentImageData: null,
    sidebarActive: false
  },
  onInit: function() {
    console.log('Chat page loaded')
  },
  handleInputChange: function(e) {
    this.message = e.value
  },
  openSidebar: function() {
    // In the future, this will activate sidebar
    this.$app.$def.showToast('侧边栏功能即将推出')
    this.sidebarActive = true
  },
  closeSidebar: function() {
    this.sidebarActive = false
  },
  startNewChat: function() {
    this.message = ''
    this.currentImageData = null
    this.$app.$def.showToast('开始新的对话')
  },
  handleImageUpload: function() {
    this.$app.$def.showToast('图片上传功能即将推出')
  },
  handleWebSearch: function() {
    this.$app.$def.showToast('网页搜索功能即将推出')
  },
  sendMessage: function() {
    if (!this.message.trim() && !this.currentImageData) {
      return
    }
    
    if (this.isProcessingMessage) {
      return
    }
    
    this.$app.$def.showToast('消息发送功能即将推出')
    this.message = ''
  }
}
</script>

<style>
.page {
  flex-direction: column;
  background-color: #f3f4f6;
  width: 100%;
  height: 100%;
}

/* Header Styles */
.chat-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 16px;
  background-color: #ffffff;
  border-bottom: 1px solid #e5e7eb;
}

.chat-header-title {
  font-size: 24px;
  font-weight: bold;
  color: #111827;
}

.header-button {
  padding: 8px;
  border-radius: 8px;
  background: none;
}

.header-icon {
  width: 24px;
  height: 24px;
  color: #6b7280;
  text-align: center;
  font-size: 24px;
}

/* Content Area Styles */
.chat-content {
  flex: 1;
  overflow-y: scroll;
  padding: 16px;
}

.chat-welcome {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 24px;
  margin: auto;
}

.logo-container {
  display: flex;
  justify-content: center;
  align-items: center;
  width: 80px;
  height: 80px;
  background-color: #10a37f;
  border-radius: 40px;
  margin-bottom: 16px;
  box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1);
}

.logo-text {
  font-size: 32px;
  font-weight: bold;
  color: #ffffff;
  text-align: center;
}

.welcome-title {
  font-size: 24px;
  font-weight: bold;
  color: #10a37f;
  margin-bottom: 8px;
}

.welcome-message {
  font-size: 16px;
  color: #4b5563;
  text-align: center;
  line-height: 1.8;
  max-width: 450px;
}

/* Input Area Styles - Redesigned to match webapp */
.chat-input-area {
  padding: 12px 16px;
  border-top: 1px solid #e5e7eb;
  background-color: #ffffff;
}

.input-area-toolbar {
  display: flex;
  gap: 12px;
  margin-bottom: 12px;
}

.toolbar-button {
  display: flex;
  align-items: center;
  padding: 8px;
  border-radius: 8px;
  background-color: #f3f4f6;
  border: 1px solid #e5e7eb;
}

.toolbar-icon {
  width: 20px;
  height: 20px;
  margin-right: 4px;
  font-size: 16px;
  color: #6b7280;
}

.toolbar-text {
  font-size: 14px;
  color: #6b7280;
}

.input-area-wrapper {
  display: flex;
  align-items: flex-end;
  gap: 12px;
}

.text-input {
  flex: 1;
  min-height: 44px;
  max-height: 120px;
  padding: 12px;
  border: 1px solid #e5e7eb;
  border-radius: 16px;
  background-color: #f9fafb;
  font-size: 16px;
}

.send-button {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 44px;
  height: 44px;
  border-radius: 22px;
  background-color: #10a37f;
  flex-shrink: 0;
}

.send-icon {
  color: #ffffff;
  font-size: 20px;
  font-weight: bold;
}

/* Sidebar Styles (Prepared but not fully implemented) */
.sidebar-overlay {
  position: fixed;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.5);
  z-index: 998;
}
</style>
